% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pam.sim_data.R
\name{sim_cox_weibull_censored}
\alias{sim_cox_weibull_censored}
\title{Simulate Cox survival data with optional interaction terms and targeted censoring}
\usage{
sim_cox_weibull_censored(
  n,
  pi_c,
  v,
  beta,
  mu = NULL,
  sd = NULL,
  seed = NULL,
  interact = FALSE,
  nonlinear = FALSE
)
}
\arguments{
\item{n}{Integer. Sample size.}

\item{pi_c}{Numeric in \eqn{[0, 0.99]}. Target censoring proportion. Ignored if both
\code{mu} and \code{sd} are provided.}

\item{v}{Positive numeric. Weibull shape in \eqn{H_0(t) = (0.5 t)^v}.}

\item{beta}{Numeric vector of regression coefficients. 
If \code{interact = FALSE}, its length defines the number of main effects. 
If \code{interact = TRUE}, its length must be either 3 (two main + one interaction) 
or 7 (three main + four interactions).}

\item{mu}{Optional numeric. Mean of \eqn{\log C}. If supplied with \code{sd}, 
no calibration is performed.}

\item{sd}{Optional positive numeric. Standard deviation used in 
\eqn{\log C = \mu + r_i}. If \code{NULL}, defaults to \eqn{\mathrm{sd}(\log Y)}.}

\item{seed}{Optional integer seed for reproducibility.}

\item{interact}{Logical (default \code{FALSE}). 
If \code{TRUE}, include pre-defined interaction terms as described above.}
}
\value{
A \code{data.frame} with columns:
\itemize{
  \item \code{time}: observed time \eqn{T_i = \min(Y_i, C_i)}.
  \item \code{status}: event indicator \eqn{1\{Y_i \le C_i\}}.
  \item \code{x1, x2, ...}: simulated covariates.
  \item \code{x1:x2, x1:x3, ...}: interaction terms (if \code{interact = TRUE}).
  \item \code{y_true}: latent event time \eqn{Y_i}.
  \item \code{cens_time}: censoring time \eqn{C_i}.
}

Attributes include:
\itemize{
  \item \code{mu}: censoring shift used.
  \item \code{sd_log}: standard deviation used in \eqn{\log C}.
  \item \code{sd_logY}: \eqn{\mathrm{sd}(\log Y)} from the generated events.
  \item \code{pi_c_target}: requested censoring rate.
  \item \code{pi_c_observed}: realized censoring rate.
  \item \code{v}, \code{beta}: model parameters.
  \item \code{interact}: logical flag indicating whether interactions were included.
  \item \code{nonlinear}: logical flag indicating whether polynomial and interactions term were included.
}
}
\description{
Generates survival data under a Cox proportional hazards model with a Weibull
baseline cumulative hazard \eqn{H_0(t) = (0.5 t)^v}. Event times are sampled via
inverse transform:
\deqn{Y = H_0^{-1}(-\log U \cdot \exp(-\beta^\top Z)), \quad U \sim \mathrm{Unif}(0,1),}
where \eqn{H_0^{-1}(s) = 2 s^{1/v}}. 

Covariates are simulated from a standard normal distribution.
When \code{interact = FALSE}, the design matrix \eqn{Z} contains only main effects.
When \code{interact = TRUE}, the function automatically detects whether \code{length(beta)} 
equals 3 or 7:
\itemize{
  \item If \code{length(beta) = 3}, two covariates (\eqn{x_1, x_2}) and their 
        two-way interaction (\eqn{x_1 x_2}) are included.
  \item If \code{length(beta) = 7}, three covariates (\eqn{x_1, x_2, x_3}), 
        their three two-way interactions (\eqn{x_1 x_2, x_1 x_3, x_2 x_3}), 
        and their three-way interaction (\eqn{x_1 x_2 x_3}) are included.
}

Right-censoring times are generated as \eqn{C_i = \exp(\mu + r_i)} with 
\eqn{r_i \sim \mathcal{N}(0, \mathrm{sd}^2)}. By default, \code{sd} is set to 
\eqn{\mathrm{sd}(\log Y)}, and \code{mu} is calibrated so that the expected censoring 
proportion equals \code{pi_c}. If \code{mu} and/or \code{sd} are supplied, calibration 
is skipped accordingly:
\itemize{
  \item \strong{mu and sd provided:} use them directly (no calibration).
  \item \strong{sd only:} solve for \code{mu} using the given \code{sd}.
  \item \strong{mu only:} use the given \code{mu} and estimate \eqn{\mathrm{sd}(\log Y)}.
  \item \strong{neither:} estimate both \eqn{\mathrm{sd}(\log Y)} and \code{mu}.
}
}
\examples{
# (1) Main effects only
set.seed(1)
d0 <- sim_cox_weibull_censored(500, 0.3, v = 1.2, beta = c(0.4, -0.2))

# (2) Two covariates + their interaction
d1 <- sim_cox_weibull_censored(500, 0.3, v = 1.2, 
                               beta = c(0.5, -0.3, 0.2), 
                               interact = TRUE)

# (3) Three covariates + all two-way and three-way interactions
b <- c(0.4, -0.2, 0.1, 0.15, -0.05, 0.08, 0.02)
d2 <- sim_cox_weibull_censored(500, 0.3, v = 1.0, beta = b, interact = TRUE)

}
